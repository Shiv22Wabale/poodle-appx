- query: "SELECT * FROM namespace WHERE deleted = 0"
  map_def:
      - name: sql.namespaces
        key:
            - "$@.namespace"
        value: "$@"

  arr_def:
      - name: sql.namespace_arr
        value: "$@"

- query: "SELECT * FROM app WHERE deleted = 0"
  map_def:
      - name: sql.apps
        key:
            - "$@.namespace"
            - "$@.app_name"
            - "$@.app_ver"
        value: "$@"

- query: "SELECT * FROM runtime WHERE deleted = 0"
  map_def:
      - name: sql.runtimes
        key:
            - "$@.namespace"
            - "$@.runtime_name"
        value: "$@"

- query: "SELECT * FROM deployment WHERE deleted = 0"
  map_def:
      - name: sql.deployments_by_runtime
        key:
            - "$@.namespace"
            - "$@.runtime_name"
            - "$@.app_name"
        value: "$@"

      - name: sql.deployments_by_app
        key:
            - "$@.namespace"
            - "$@.app_name"
            - "$@.runtime_name"
        value: "$@"

- query: "SELECT * FROM obj WHERE deleted = 0"
  map_def:
      - name: sql.objs
        key:
            - "$@.namespace"
            - "$@.app_name"
            - "$@.app_ver"
            - "$@.obj_name"
        value: "$@"

- query: "SELECT * FROM relation WHERE deleted = 0"
  map_def:
      - name: sql.relations_1ton
        key:
            - "$@.namespace"
            - "$@.app_name"
            - "$@.app_ver"
            - "$@.obj_name"
            - "$@.objn_name"
        value: "$@"

      - name: sql.relations_nto1
        key:
            - "$@.namespace"
            - "$@.app_name"
            - "$@.app_ver"
            - "$@.objn_name"
            - "$@.obj_name"
        value: "$@"

- query: "SELECT * FROM api WHERE deleted = 0"
  map_def:
      - name: sql.apis_by_method
        key:
            - "$@.namespace"
            - "$@.app_name"
            - "$@.app_ver"
            - "$@.obj_name"
            - "$@.api_method"
            - "$@.api_endpoint"
        value: "$@"

      - name: sql.apis_by_endpoint
        key:
            - "$@.namespace"
            - "$@.app_name"
            - "$@.app_ver"
            - "$@.obj_name"
            - "$@.api_endpoint"
            - "$@.api_method"
        value: "$@"

- query: "SELECT * FROM transform WHERE deleted = 0"
  map_def:
      - name: sql.transforms
        key:
            - "$@.namespace"
            - "$@.app_name"
            - "$@.app_ver"
            - "$@.obj_name"
            - "$@.transform_name"
        value: "$@"
